# Web node
web:
  image: blinkreaction/drupal-nginx-php
  ports:
    - "80:80"
  volumes:
    # PHP configuration overrides
    - "./.docker/etc/php5/php.ini:/etc/php5/fpm/conf.d/99-php.ini"
    # Drupal docroot mapping
    - "./docroot:/var/www"
  links:
    - db

# DB node
db:
  image: mysql:5.5
  ports:
    - "3306:3306"
  # DB configuration
  environment:
    - MYSQL_ROOT_PASSWORD=admin123
    - MYSQL_USER=drupal
    - MYSQL_PASSWORD=123
    - MYSQL_DATABASE=drupal
  volumes:
     # MySQL configuration overrides
     - "./.docker/etc/mysql/my.cnf:/etc/mysql/conf.d/99-my.cnf"
  volumes_from:
    # Map a data volume for /var/lib/mysql
    - dbdata

# Data-only container for db. 
# Either use the command (prefered):
# docker run -d -v /var/lib/mysql --name dbdata mysql:5.5
# OR uncomment the dbdata service below, in which case `fig rm` will remove your DB data as well!
dbdata:
  image: mysql:5.5
  volumes:
    - /var/lib/mysql
  command: echo "Data-only container for db"
